plugins {
    id("org.asciidoctor.jvm.revealjs") version "3.3.2"
}

// keep using the groovy DSL otherwise ruby.gem() will raise an "Unresolved reference"
repositories {
    mavenCentral()
    ruby.gems()
}


// Speaker mode: type `s`
// Fullscreen mode: type `o`
// Fullscreen mode: type `f`


// See https://asciidoctor.github.io/asciidoctor-gradle-plugin/development-3.x/user-guide/#asciidoctorj-revealjs-plugin
revealjs {
    version = "4.1.0" // ruby asciidoctor-revealjs backend
}


asciidoctorRevealJs {
    outputDir("$buildDir/docs")
    baseDirFollowsSourceDir()
    sourceDir("src/docs/asciidoc")
    sources {
        include("index.adoc")
    }
//    resources {
//        from("${sourceDir}/images") {
//            include '**'
//            into 'images'
//        }
////        from("${sourceDir}/css") {
////            include '**'
////            into 'css'
////        }
//    }
    attributes(
            "sourceDir": "src/docs/asciidoc",
            "imagesDir": "",
            "toc": "left",
            "icons": "font",
            "iconfont-name": "fontawesome-5.8.0",
            // Configurations not available via the `revealjsOptions` block
            // https://revealjs.com/config/
//            "revealjs_width": "1920",
//            "revealjs_height": "1080",
//            "revealjs_customtheme": "css/tweaks.css",
            "revealjs_controlsLayout": "edges", // Determines where controls appear, "edges" or "bottom-right"
            "revealjs_navigationMode": "linear" // Changes to linear navigation (left -right)
    )
    theme("blood") // https://revealjs.com/themes/
//    clearSecondarySources()
    revealjsOptions {
        setControls(true) // Display presentation control arrows
        setSlideNumber("c/t") // Display current over total slide number
        setOverviewMode(true) // Enable the slide overview mode https://revealjs.com/overview/
        setTransition("fade") // Slide transition style (none/fade/slide/convex/concave/zoom)
//        setBackgroundTransition("convex") // Transition style for full page slide backgrounds
//        setCustomThemeLocation("src/docs/css/tweaks.css") // fails with  Entry style/tweaks.css is a duplicate but no duplicate handling strategy has been set.
    }
}


asciidoctorj {
    version("2.5.2")
    fatalWarnings missingIncludes()
    modules {
        diagram.use()
        diagram.setVersion("2.2.1")
    }
}


build.dependsOn(asciidoctorRevealJs)